## üéØ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ë–ê–ì–û–í –° –§–£–ù–ö–¶–ò–Ø–ú–ò (–ó–ê–í–ï–†–®–ï–ù–û) - 03.01.2025

**‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–û:** –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!

### üèÅ –§–ò–ù–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï (03.01.2025):
- ‚úÖ **–ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏** - —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** `–°—É–º–º–∞(–ö–≤–∞–¥—Ä–∞—Ç(x), –ö–≤–∞–¥—Ä–∞—Ç(y))` - —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
- ‚úÖ **–ò–∑–æ–ª—è—Ü–∏—è –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏** - –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Å–≤–æ–µ–π –æ–±–ª–∞—Å—Ç–∏
- ‚úÖ **–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö - —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤
- ‚úÖ **–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è
- ‚úÖ **–¢–µ—Å—Ç—ã func-sumdig.kum –∏ func-prime.kum** - –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ –ª–æ–≥–∞–º

### –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞:

**üêõ –î–í–û–ô–ù–ê–Ø –û–ë–ï–†–¢–ö–ê KUMIRVALUE –í EXPRESSION_EVALUATOR** 
- **–ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã:** –í `visitQualifiedIdentifier` (expression_evaluator.py:650):
  ```python
  value = var_info['value']      # –≠—Ç–æ —É–∂–µ KumirValue 
  kumir_type = var_info['kumir_type']  # –≠—Ç–æ KumirType.INT (enum)
  return KumirValue(value, kumir_type)  # –î–í–û–ô–ù–ê–Ø –û–ë–ï–†–¢–ö–ê!
  ```
- **–°–∏–º–ø—Ç–æ–º—ã:** 
  - –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π —Å–æ–¥–µ—Ä–∂–∞–ª–∏ `KumirValue(value=KumirValue(value=3, kumir_type='–¶–ï–õ'), kumir_type='KumirType.INT')`
  - –û—à–∏–±–∫–∞: `KumirTypeError: –û–ø–µ—Ä–∞—Ü–∏—è —Å–ª–æ–∂–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–∞ –∫ —Ç–∏–ø–∞–º 'KumirType.INT' –∏ 'KumirType.INT'`
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `visitQualifiedIdentifier` - —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ `value` —É–∂–µ `KumirValue`, –∏ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ: `–°—É–º–º–∞(–ö–≤–∞–¥—Ä–∞—Ç(x), –ö–≤–∞–¥—Ä–∞—Ç(y))` = 25 ‚úÖ

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **ÔøΩ –ò–∑–æ–ª—è—Ü–∏—è –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–π**
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `__–∑–Ω–∞—á__` –æ–±—ä—è–≤–ª—è–ª–∞—Å—å –≤ –æ–¥–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
   - **–†–µ—à–µ–Ω–∏–µ:** –í `execute_user_function` –¥–æ–±–∞–≤–ª–µ–Ω—ã `push_scope()` –∏ `pop_scope()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏

2. **üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏** –≤ procedure_manager.py
   - –†–∞–∑–¥–µ–ª–µ–Ω—ã —Å–∫–ª–µ–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ –Ω–∞ –ª–∏–Ω–∏—è—Ö 547, 576, 578, 580, 582, 585, 590
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ try/except –±–ª–æ–∫–æ–≤

### üß™ –£–°–ü–ï–®–ù–û –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–ù–´–ï –°–¶–ï–ù–ê–†–ò–ò:

**‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
```kumir
–∞–ª–≥ —Ü–µ–ª –£–¥–≤–æ–∏—Ç—å(–∞—Ä–≥ —Ü–µ–ª x)
–Ω–∞—á
    –∑–Ω–∞—á := x * 2
–∫–æ–Ω
—Ä–µ–∑—É–ª—å—Ç–∞—Ç := –£–¥–≤–æ–∏—Ç—å(5)  // –†–µ–∑—É–ª—å—Ç–∞—Ç: 10
```

**‚úÖ –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
```kumir
–∞–ª–≥ —Ü–µ–ª –ö–≤–∞–¥—Ä–∞—Ç(–∞—Ä–≥ —Ü–µ–ª x)
–Ω–∞—á
    –∑–Ω–∞—á := x * x
–∫–æ–Ω

–∞–ª–≥ —Ü–µ–ª –°—É–º–º–∞(–∞—Ä–≥ —Ü–µ–ª a, –∞—Ä–≥ —Ü–µ–ª b) 
–Ω–∞—á
    –∑–Ω–∞—á := a + b
–∫–æ–Ω

—Ä–µ–∑—É–ª—å—Ç–∞—Ç := –°—É–º–º–∞(–ö–≤–∞–¥—Ä–∞—Ç(3), –ö–≤–∞–¥—Ä–∞—Ç(4))  // –†–µ–∑—É–ª—å—Ç–∞—Ç: 25 (9 + 16)
```

### üßπ –í–´–ü–û–õ–ù–ï–ù–ù–ê–Ø –û–ß–ò–°–¢–ö–ê:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–≤–æ–π–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ KumirValue –≤ expression_evaluator.py
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–∑–æ–ª—è—Ü–∏—è –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–æ—Å—Ç—ã–µ –∏ —Å–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π

### üìã TODO (–ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢):
1. **–ö–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:** –£–±—Ä–∞—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ debug –ª–æ–≥–∏
2. **–¢–∏–ø—ã –≤ debug:** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å `'–¶–ï–õ'` –≤–º–µ—Å—Ç–æ `'KumirType.INT'` –≤ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–º –≤—ã–≤–æ–¥–µ
3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã:** –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Ñ—É–Ω–∫—Ü–∏–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞
    –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω—Å
–∫–æ–Ω
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:** ‚úÖ –í—ã–≤–æ–¥–∏—Ç `10` (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!)

### –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã:
1. `pyrobot/backend/kumir_interpreter/interpreter_components/expression_evaluator.py`
2. `pyrobot/backend/kumir_interpreter/interpreter_components/procedure_manager.py`  
3. `pyrobot/backend/kumir_interpreter/interpreter_components/statement_handlers.py`

**–°–æ—Å—Ç–æ—è–Ω–∏–µ:** –í–°–ï –§–£–ù–ö–¶–ò–ò –†–ê–ë–û–¢–ê–Æ–¢ –ö–û–†–†–ï–ö–¢–ù–û! üéâ –û—Å—Ç–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫–æ–¥–∞.

---

# –ó–∞–º–µ—Ç–∫–∏ AI –ø–æ –ü—Ä–æ–µ–∫—Ç—É PyRobot

---

## 1. –û–±—â–∞—è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –ü—Ä–æ–µ–∫—Ç—É PyRobot

* **–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:**
  * –í—Å–µ —Ç–µ—Å—Ç—ã: `python -m pytest -v tests/test_functional.py > test_log.log`
  * –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç: `python -m pytest -v tests/test_functional.py -k "–∏–º—è_—Ñ–∞–π–ª–∞.kum"  > test_log.log`
  * –í—Å–µ —Ñ–∞–π–ª—ã kum: `tests/polyakov_kum`
* **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —è–∑—ã–∫—É –ö—É–º–∏—Ä:** `kumir2-master/userdocs/`
* **–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ö—É–º–∏—Ä–∞ (C++):** `kumir2-master/src`
* **–ù–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏:** `kumir2-master/src/kumir2-libs`, `kumir2-master/src/plugins`

---

## 0. –õ–ò–ù–¢–ï–† –ò –ö–ê–ß–ï–°–¢–í–û –ö–û–î–ê (–í–´–ü–û–õ–ù–ï–ù–û)

**‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û (21.01.2025):** –í—Å–µ –æ—à–∏–±–∫–∏ –ª–∏–Ω—Ç–µ—Ä–∞ flake8 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–æ –≤—Å–µ—Ö Python —Ñ–∞–π–ª–∞—Ö!

**–ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:**
1. **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω flake8 –ª–∏–Ω—Ç–µ—Ä** –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `--max-line-length=88 --ignore=E501,W503,E203`
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞:**
   - `pyrobot/backend/server.py` - —É–¥–∞–ª–µ–Ω–æ 200+ –ª–∏—à–Ω–∏—Ö —Ç–æ—á–µ–∫ —Å –∑–∞–ø—è—Ç–æ–π, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ç–∞–±—É–ª—è—Ü–∏—è
   - `pyrobot/backend/kumir_interpreter/utils.py` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤ –∏ docstring
   - `pyrobot/backend/kumir_interpreter/system_functions.py` - —Ç–∞–±—É–ª—è—Ü–∏—è ‚Üí 4 –ø—Ä–æ–±–µ–ª–∞
   - `pyrobot/backend/kumir_interpreter/safe_eval.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ç–∞–±—É–ª—è—Ü–∏—è
   - `pyrobot/backend/kumir_interpreter/string_utils.py` - —Ä–∞–∑–±–∏—Ç—ã –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
   - `pyrobot/backend/kumir_interpreter/text_functions.py` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**
   - `tests/__init__.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –∫–æ–Ω—Ü–µ
   - `tests/test_functional.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –ø—Ä–æ–±–µ–ª—ã, –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
   - `tests/test_parser.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
   - `tests/test_tables.py` - —É–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ç–∞–±—É–ª—è—Ü–∏—è

4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –í–°–Ø —Ç–∞–±—É–ª—è—Ü–∏—è –≤ 4-–ø—Ä–æ–±–µ–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã
   - –£–¥–∞–ª–µ–Ω–æ 200+ –ª–∏—à–Ω–∏—Ö —Ç–æ—á–µ–∫ —Å –∑–∞–ø—è—Ç–æ–π
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 50+ –Ω–∞—Ä—É—à–µ–Ω–∏–π –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫
   - –î–æ–±–∞–≤–ª–µ–Ω–æ 20+ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 30+ –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏

**–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:** –ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PEP8!

---

## 2. –ó–ê–î–ê–ß–ê: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä (–û–°–ù–û–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê!)

**‚úÖ –°–¢–ê–¢–£–°:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ü–†–û–†–´–í! Stack-based return values –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç! (02.06.2025)

### 2.1. Stack-Based Return Value Management (–†–ï–ê–õ–ò–ó–û–í–ê–ù–û)

**‚úÖ –ó–ê–í–ï–†–®–ï–ù–û:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å—Ç–µ–∫–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Ñ—É–Ω–∫—Ü–∏–π

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
1. **–î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–µ–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ procedure_manager.py:**
   ```python
   self._return_value_stack: List[Optional[KumirValue]] = []
   ```

2. **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–µ–∫–æ–º:**
   - `push_return_value_frame()` - —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —Ñ—Ä–µ–π–º –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏
   - `pop_return_value_frame()` - —É–¥–∞–ª—è–µ—Ç —Ñ—Ä–µ–π–º –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
   - `get_and_clear_return_value()` - –ø–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è —Ñ—Ä–µ–π–º–∞

3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ ProcedureManager:** 
   - –°—Ç—Ä–æ–∫–∞ 19 –±—ã–ª–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

4. **–û–±–Ω–æ–≤–ª–µ–Ω _call_user_function() –≤ main_visitor.py:**
   - –î–æ–±–∞–≤–ª–µ–Ω `push_return_value_frame()` –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏
   - –î–æ–±–∞–≤–ª–µ–Ω `pop_return_value_frame()` –≤ finally –±–ª–æ–∫–µ
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### 2.2. ‚úÖ –ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï: Stack-Based Return Value Management (02.06.2025)

**üéâ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê!** –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

**–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
1. **–£–¥–∞–ª–µ–Ω –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Ç–µ–∫—Å—Ç:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ `procedure_manager.py` —Å—Ç—Ä–æ–∫–∞ 19 - —É–¥–∞–ª–µ–Ω —Å—Ç–æ—è–≤—à–∏–π —Ç–∞–º —Ç–µ–∫—Å—Ç "–°–µ–∫—É–Ω–¥—É."
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ try-finally –±–ª–æ–∫–æ–≤:** –£–±—Ä–∞–Ω –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–π `return` –∏–∑ except –±–ª–æ–∫–∞ –≤ `_call_user_function()`
3. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π:** –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ output –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ü–ï–†–ï–î finally –±–ª–æ–∫–æ–º
4. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–µ–∫–∞:** Finally –±–ª–æ–∫ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏ –æ—á–∏—â–∞–µ—Ç —Å—Ç–µ–∫

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
```python
# –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –ü–†–û–ë–õ–ï–ú–ê:
try:
    self.visit(algorithm_def.body_context)
except FunctionReturnException as return_exc:
    return_value = return_exc.return_value
    return return_value  # –ü–†–ï–ñ–î–ï–í–†–ï–ú–ï–ù–ù–´–ô –í–´–•–û–î!
finally:
    # –≠—Ç–æ—Ç –∫–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è!
    
# –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –†–ï–®–ï–ù–ò–ï:
try:
    self.visit(algorithm_def.body_context)
except FunctionReturnException as return_exc:
    return_value = return_exc.return_value
    
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –í–ù–ï try-except
for output_param in output_parameters:
    # ... –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ ...

finally:
    # –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è!
    self.procedure_manager.pop_return_value_frame()
    
return return_value  # –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô return –≤ –∫–æ–Ω—Ü–µ
```

**–£—Å–ø–µ—à–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: `double(5)` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `10` 
- ‚úÖ Debug –ª–æ–≥–∏: `–§—É–Ω–∫—Ü–∏—è 'double' –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ: 10` ‚Üí `–ø–æ–ª—É—á–∏–ª: 10`
- ‚úÖ Expression evaluator –ø–æ–ª—É—á–∞–µ—Ç KumirValue –≤–º–µ—Å—Ç–æ None
- ‚úÖ Stack management —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤

### 2.3. üö® –°–õ–ï–î–£–Æ–©–ê–Ø –ó–ê–î–ê–ß–ê: –ò–∑–æ–ª—è—Ü–∏—è –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

**‚ùå –ù–û–í–ê–Ø –û–ë–ù–ê–†–£–ñ–ï–ù–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:** –ü—Ä–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∞: `DeclarationError: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è 'n' —É–∂–µ –æ–±—ä—è–≤–ª–µ–Ω–∞ –≤ —Ç–µ–∫—É—â–µ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏`
- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ `factorial(n-1)` - –≤—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—ä—è–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä 'n' –∑–∞–Ω–æ–≤–æ
- Scope manager –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è —Ä–µ–∫—É—Ä—Å–∏–∏

**–ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** 
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `scope_manager.py` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ—á–∏—Å—Ç–∫—É –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏

**–ü–†–û–ë–õ–ï–ú–ê:** –í—ã–∑–æ–≤—ã –ø—Ä–æ—Ü–µ–¥—É—Ä –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ evaluator –≤—ã—Ä–∞–∂–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä.

**–ö–û–†–ï–ù–¨ –ü–†–û–ë–õ–ï–ú–´:** –í `statement_handlers.py:163` –º–µ—Ç–æ–¥ `visitAssignmentStatement` –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –≤—ã–∑–æ–≤—ã –ø—Ä–æ—Ü–µ–¥—É—Ä, –≤ `expression_evaluator` –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∫ –º–µ—Ö–∞–Ω–∏–∑–º—É –≤—ã–∑–æ–≤–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä.

**–ß–¢–û –°–î–ï–õ–ê–ù–û:**
1. **–ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:** –í—ã—è–≤–ª–µ–Ω–∞ –¥–≤–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:
   - –§—É–Ω–∫—Ü–∏–∏: `expression_evaluator` ‚Üí `procedure_manager.call_function`  
   - –ü—Ä–æ—Ü–µ–¥—É—Ä—ã: `statement_handlers` ‚Üí `procedure_manager.call_procedure`

2. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
   - `AlgorithmManager` —Å –º–µ—Ç–æ–¥–∞–º–∏ `is_function()` –∏ `is_procedure()` –≤ `definitions.py`
   - `visitProcedureCallStatement` –≤ `statement_handlers.py:608-629` (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ—Ü–µ–¥—É—Ä)
   - –ú–µ—Ç–æ–¥ `procedure_manager.call_procedure()` (–ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é)

3. **–°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞:** –î–æ–±–∞–≤–ª–µ–Ω `_extract_procedure_name_from_expression()` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–º–µ–Ω –ø—Ä–æ—Ü–µ–¥—É—Ä –∏–∑ AST –≤—ã—Ä–∞–∂–µ–Ω–∏–π

4. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤:** –î–æ–±–∞–≤–ª–µ–Ω –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –∏–º–ø–æ—Ä—Ç `KumirLexer` –≤ `statement_handlers.py`

5. **–ù–∞—á–∞—Ç–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:** –ò–∑–º–µ–Ω—è–µ—Ç—Å—è `visitAssignmentStatement` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –≤—ã–∑–æ–≤–æ–≤ –ø—Ä–æ—Ü–µ–¥—É—Ä

**–ß–¢–û –û–°–¢–ê–õ–û–°–¨:**
1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É procedure_manager.call_procedure:** –¢–µ–∫—É—â–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
2. **–ó–∞–≤–µ—Ä—à–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤ procedure_manager –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ –ø—Ä–æ—Ü–µ–¥—É—Ä  
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—ã–∑–æ–≤—ã –ø—Ä–æ—Ü–µ–¥—É—Ä —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. **–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏:** –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –≤—ã–∑–æ–≤–æ–≤ –ø—Ä–æ—Ü–µ–¥—É—Ä vs –æ–±—ã—á–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π

---

## 3. –ó–∞–¥–∞—á–∏ –ø–æ –î–æ—Ä–∞–±–æ—Ç–∫–µ –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ –ö—É–ú–∏—Ä–∞ (–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –°–ø–∏—Å–æ–∫)

1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤:** –ü—Ä–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–∏, –ø–µ—Ä–µ–¥–∞—á–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –≤ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö.
2. **–û–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏:** –ì–ª–æ–±–∞–ª—å–Ω—ã–µ, –ª–æ–∫–∞–ª—å–Ω—ã–µ, –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –∏–º–µ–Ω, –≤–∏–¥–∏–º–æ—Å—Ç—å –≤ –±–ª–æ–∫–∞—Ö.
3. **–ú–∞—Å—Å–∏–≤—ã:** –û–±—ä—è–≤–ª–µ–Ω–∏–µ, –¥–æ—Å—Ç—É–ø –ø–æ –∏–Ω–¥–µ–∫—Å—É, –∫–æ–Ω—Ç—Ä–æ–ª—å –≥—Ä–∞–Ω–∏—Ü, –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã.
4. **–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏:** –û–±—ä—è–≤–ª–µ–Ω–∏–µ, –≤—ã–∑–æ–≤, –ø–µ—Ä–µ–¥–∞—á–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (–∑–Ω–∞—á–µ–Ω–∏–µ/—Å—Å—ã–ª–∫–∞ `–∞—Ä–≥ —Ä–µ–∑`), –≤–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–π, —Ä–µ–∫—É—Ä—Å–∏—è.
5. **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è (`—Ü–µ–ª`, `–≤–µ—â`, `–ª–æ–≥`, `—Ç–µ–∫—Å—Ç`, `–¥–ª–∏–Ω–∞`, `–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å`, `–≤–≤–æ–¥`, `–≤—ã–≤–æ–¥` –∏ —Ç.–¥.).
6. **–£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:** –¶–∏–∫–ª—ã (`–Ω—Ü –¥–ª—è`, `–Ω—Ü –ø–æ–∫–∞`, `–∫—Ü`), —É—Å–ª–æ–≤–∏—è (`–µ—Å–ª–∏
7. **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:** `—Ü–µ–ª`, `–≤–µ—â`, `–ª–æ–≥`, `—Å–∏–º`, `–ª–∏—Ç`. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤.
8. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:** –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (`|` –¥–æ –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫–∏).
9. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ü–∞ —Ñ–∞–π–ª–∞ –∏ –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

---

## 3. –ö–ª—é—á–µ–≤—ã–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –£–ª—É—á—à–µ–Ω–∏—è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –í—ã—Ä–∞–∂–µ–Ω–∏—è

**‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ë–ê–ì –ò–°–ü–†–ê–í–õ–ï–ù:** –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ—Å—Ç `2-2+2.kum` –≤—ã–≤–æ–¥–∏–ª "–û—Ç–≤–µ—Ç: 2" –≤–º–µ—Å—Ç–æ "–û—Ç–≤–µ—Ç: 4" - –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –Ω–µ –≤—ã—á–∏—Å–ª—è–ª–∞—Å—å.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ `expression_evaluator.py`:**

1. **visitRelationalExpression:** –ó–∞–º–µ–Ω—ë–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø `ctx.expression()` –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `ctx.additiveExpression()`
2. **visitAdditiveExpression:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞—Å—Ç–æ—è—â–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ pass-through
3. **visitMultiplicativeExpression:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ *, /, div, mod –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏** —Å –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–º –∫–æ–¥–æ–º –≤ Python

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

* ‚úÖ `python test_current.py` ‚Üí "–û—Ç–≤–µ—Ç: 4" (–±—ã–ª–æ "–û—Ç–≤–µ—Ç: 2")
* ‚úÖ –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ `2+2` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ `4`
* ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤ –¶–ï–õ/–í–ï–©

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è `2-2+2.kum`
2. –£–±—Ä–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ print –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã
3. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥—Ä—É–≥–∏—Ö —É—Ä–æ–≤–Ω–µ–π –æ–ø–µ—Ä–∞—Ü–∏–π (—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ, –ª–æ–≥–∏—á–µ—Å–∫–∏–µ)

---

### –†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –û–ø–µ—Ä–∞—Ü–∏–∏

**‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ë–ê–ì –ò–°–ü–†–ê–í–õ–ï–ù:** –†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (>, <, >=, <=, =, <>) —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ—Å—Ç `8-if.kum` –≤—ã–≤–æ–¥–∏–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è - "5,7,7,5" –≤–º–µ—Å—Ç–æ "7,7,7,7".
–û–ø–µ—Ä–∞—Ü–∏—è `a > b` –≥–¥–µ a=5, b=7 –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ true –≤–º–µ—Å—Ç–æ false.

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**

1. –í –∞–∫—Ç–∏–≤–Ω–æ–º —Ñ–∞–π–ª–µ `interpreter_components/expression_evaluator.py` –º–µ—Ç–æ–¥ `visitRelationalExpression` —Å–æ–¥–µ—Ä–∂–∞–ª —Ç–æ–ª—å–∫–æ `raise KumirNotImplementedError`
2. **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –°–ò–ù–¢–ê–ö–°–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê:** –î–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±—ã–ª–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É:

   ```python
   return self.visit(ctx.relationalExpression(0))  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç    def visitRelationalExpression(...):
   ```

   –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ ANTLR –Ω–µ –º–æ–≥ –Ω–∞–π—Ç–∏ –º–µ—Ç–æ–¥ `visitRelationalExpression` –∏ –≤—ã–∑—ã–≤–∞–ª fallback –º–µ—Ç–æ–¥—ã.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

1. **–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:** `operator`, `KumirLexer` –¥–ª—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
2. **–î–æ–±–∞–≤–ª–µ–Ω —Å–ª–æ–≤–∞—Ä—å –æ–ø–µ—Ä–∞—Ü–∏–π:**

   ```python
   COMPARISON_OPS = {
       KumirLexer.EQ: operator.eq,   # =
       KumirLexer.NE: operator.ne,   # <>
       KumirLexer.LT: operator.lt,   # <
       KumirLexer.GT: operator.gt,   # >
       KumirLexer.LE: operator.le,   # <=
       KumirLexer.GE: operator.ge,   # >=
   }
   ```

3. **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π `visitRelationalExpression`:**
   * –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ü–µ–ø–æ—á–Ω—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ
   * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ (int ‚Üî float)
   * –í–æ–∑–≤—Ä–∞—Ç `KumirValue` —Å –±—É–ª–µ–≤—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
4. **–ò–°–ü–†–ê–í–õ–ï–ù–´ –°–ò–ù–¢–ê–ö–°–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò:** –†–∞–∑–¥–µ–ª–µ–Ω—ã –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

* ‚úÖ –¢–µ—Å—Ç `8-if.kum` –ø—Ä–æ—Ö–æ–¥–∏—Ç: –ø–æ–ª—É—á–∞–µ–º –æ–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ "7,7,7,7"
* ‚úÖ –†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ `>`, `<`, `>=`, `<=`, `=`, `<>` —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
* ‚úÖ –£—Å–ª–æ–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `–µ—Å–ª–∏` —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –±—É–ª–µ–≤—ã –∑–Ω–∞—á–µ–Ω–∏—è

**Debug –ø—Ä–æ—Ü–µ—Å—Å:**

* –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ debug –ª–æ–≥–æ–≤ - `visitRelationalExpression` –Ω–µ –≤—ã–∑—ã–≤–∞–ª—Å—è
* –ü—Ä–∏ `RelationalExpressionContext` —Å—Ä–∞–∑—É –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–ª—Å—è –∫ `visitAdditiveExpression`
* –ü—Ä–∏—á–∏–Ω–∞: —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏

**–°–æ—Å—Ç–æ—è–Ω–∏–µ:** –í—Å–µ debug –ª–æ–≥–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã, –∫–æ–¥ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É.

---

### –û–ø–µ—Ä–∞—Ü–∏–∏ –†–∞–≤–µ–Ω—Å—Ç–≤–∞

**‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ë–ê–ì –ò–°–ü–†–ê–í–õ–ï–ù:** –û–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ (= –∏ <>) —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ—Å—Ç `9-if.kum` –≤—ã–≤–æ–¥–∏–ª "–û–¥–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞" –≤–º–µ—Å—Ç–æ "–ë–æ—Ä–∏—Å —Å—Ç–∞—Ä—à–µ" –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö -3 –∏ 5.
–û–ø–µ—Ä–∞—Ü–∏—è `a = b` –≥–¥–µ a=-3, b=5 –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ true –≤–º–µ—Å—Ç–æ false.

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**

1. –ú–µ—Ç–æ–¥ `visitEqualityExpression` –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –Ω–æ —Å–æ–¥–µ—Ä–∂–∞–ª —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É —Å —Å–∫–ª–µ–µ–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –∫–æ–¥–∞
2. **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –°–ò–ù–¢–ê–ö–°–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê:** –°—Ç—Ä–æ–∫–∞ –∫–æ–¥–∞ –±—ã–ª–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∞ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏:

   ```python
   return self.visit(ctx.equalityExpression(0))  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç    def visitEqualityExpression(...):
   ```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–¥–µ–ª–∏–ª–∏ —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ –≤ –º–µ—Ç–æ–¥–µ `visitEqualityExpression`
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** –ú–µ—Ç–æ–¥ `visitEqualityExpression` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ —Å–ª–æ–≤–∞—Ä—å `COMPARISON_OPS`, —á—Ç–æ –∏ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –û–ø–µ—Ä–∞—Ü–∏–∏ `=` –∏ `<>` —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º —Ç–∏–ø–æ–≤

**–õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã 9-if.kum:**

* –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: a=-3, b=5
* –ü—Ä–æ–≤–µ—Ä–∫–∞ `a > b` (-3 > 5) ‚Üí false, –ø–µ—Ä–µ—Ö–æ–¥ –≤ else
* –ü—Ä–æ–≤–µ—Ä–∫–∞ `a = b` (-3 = 5) ‚Üí false (—Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!), –ø–µ—Ä–µ—Ö–æ–¥ –≤–æ –≤—Ç–æ—Ä–æ–π else
* –í—ã–≤–æ–¥: "–ë–æ—Ä–∏—Å —Å—Ç–∞—Ä—à–µ" ‚úÖ

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

* ‚úÖ –¢–µ—Å—Ç `9-if.kum` ‚Üí "–ë–æ—Ä–∏—Å —Å—Ç–∞—Ä—à–µ" (–±—ã–ª–æ "–û–¥–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞")
* ‚úÖ –¢–µ—Å—Ç `8-if.kum` ‚Üí –≤—Å—ë –µ—â—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ "7,7,7,7"
* ‚úÖ –û–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –∏ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
* ‚úÖ –¢–∏–ø—ã –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π (int ‚Üî float)

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤:** 15 –ø—Ä–æ—Ö–æ–¥—è—Ç, 49 –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç (—Ä–µ–≥—Ä–µ—Å—Å–∏–π –Ω–µ—Ç)

---

## 4. –£—Ç–æ—á–Ω–µ–Ω–∏—è –ø–æ –°–µ–º–∞–Ω—Ç–∏–∫–µ –Ø–∑—ã–∫–∞ –ö—É–ú–∏—Ä–∞

### –ö–æ–º–∞–Ω–¥–∞ `–≤—ã–≤–æ–¥` –∏ –∞—Ä–≥—É–º–µ–Ω—Ç `–Ω—Å`

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `kum_reference.md`.

* **–ö–æ–º–∞–Ω–¥–∞ `–≤—ã–≤–æ–¥`**: –ü–µ—á–∞—Ç–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –ø–æ–¥—Ä—è–¥. **–ù–µ –¥–æ–±–∞–≤–ª—è–µ—Ç** –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É (`\n`) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –∫–æ–Ω—Ü–µ.
* **–ê—Ä–≥—É–º–µ–Ω—Ç `–Ω—Å`**: –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ `–≤—ã–≤–æ–¥` –æ–∑–Ω–∞—á–∞–µ—Ç "–Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ (`\n`)".
* **–ò—Ç–æ–≥**: –ù–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–∞–º, –≥–¥–µ –≤ `–≤—ã–≤–æ–¥` —É–∫–∞–∑–∞–Ω `–Ω—Å`.

**–ü—Ä–∏–º–µ—Ä –∏–∑ `kum_reference.md` –¥–ª—è `–≤—ã–≤–æ–¥`:**

```kumir
–∞–ª–≥
–Ω–∞—á
  —Ü–µ–ª –∞; –∞ := 3
  –≤–µ—â –±; –± := 1.3
  –Ω—Ü 5 —Ä–∞–∑
    –≤—ã–≤–æ–¥ –∞, " ", –±, "–ü—Ä–∏–≤–µ—Ç!", –Ω—Å
  –∫—Ü
–∫–æ–Ω
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
3 1.3–ü—Ä–∏–≤–µ—Ç!
3 1.3–ü—Ä–∏–≤–µ—Ç!
3 1.3–ü—Ä–∏–≤–µ—Ç!
3 1.3–ü—Ä–∏–≤–µ—Ç!
3 1.3–ü—Ä–∏–≤–µ—Ç!
```

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤—ã–≤–æ–¥–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø–µ—Ä–µ–≤–æ–¥–æ–º —Å—Ç—Ä–æ–∫–∏ –∏–º–µ–Ω–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è `–Ω—Å` –≤ –∫–æ–Ω—Ü–µ —Å–ø–∏—Å–∫–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ `–≤—ã–≤–æ–¥`.

**–ü—Ä–∏–º–µ—Ä `2-2+2.kum` —Å –Ω–æ–≤—ã–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º:**
–§–∞–π–ª `tests/polyakov_kum/2-2+2.kum`:

```kumir
–∞–ª–≥ –û–ø–µ—Ä–∞—Ç–æ—Ä –≤—ã–≤–æ–¥–∞
–Ω–∞—á
  –≤—ã–≤–æ–¥ '2+'        | –í—ã–≤–µ–¥–µ—Ç "2+" –±–µ–∑ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏
  –≤—ã–≤–æ–¥ '2=?`, –Ω—Å   | –í—ã–≤–µ–¥–µ—Ç "2=?", –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏ (–∏–∑-–∑–∞ –Ω—Å)
  –≤—ã–≤–æ–¥ '–û—Ç–≤–µ—Ç: 4'  | –í—ã–≤–µ–¥–µ—Ç "–û—Ç–≤–µ—Ç: 4" –±–µ–∑ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ (–µ—Å–ª–∏ —ç—Ç–æ –∫–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–ª–∏ –¥–∞–ª—å—à–µ –Ω–µ—Ç –≤—ã–≤–æ–¥–∞ —Å –Ω—Å)
–∫–æ–Ω
```

–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ `tests/polyakov_kum/2-2+2-out.txt`:

```
2+2=?
–û—Ç–≤–µ—Ç: 4
```

–≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–µ:

1. `–≤—ã–≤–æ–¥ '2+'` -> –ø–µ—á–∞—Ç–∞–µ—Ç "2+". –ë—É—Ñ–µ—Ä: `"2+"`
2. `–≤—ã–≤–æ–¥ '2=?`, –Ω—Å` -> –ø–µ—á–∞—Ç–∞–µ—Ç "2=?". –ó–∞—Ç–µ–º `–Ω—Å` –ø–µ—á–∞—Ç–∞–µ—Ç `\\n`. –ë—É—Ñ–µ—Ä:`"2+2=?\\n"`
3. `–≤—ã–≤–æ–¥ '–û—Ç–≤–µ—Ç: 4'` -> –ø–µ—á–∞—Ç–∞–µ—Ç "–û—Ç–≤–µ—Ç: 4". –ë—É—Ñ–µ—Ä: `"2+2=?\\n–û—Ç–≤–µ—Ç: 4"`
–ï—Å–ª–∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–µ—Ç –¥—Ä—É–≥–∏—Ö –≤—ã–≤–æ–¥–æ–≤, —Ç–æ —Ç–∞–∫ –∏ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è. –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ç–æ —Ç–∞–∫–æ–π –≤—ã–≤–æ–¥ –∏ –±—É–¥–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–º.

**–í—ã–≤–æ–¥:** –≠—Ç–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –æ—Ç–º–µ–Ω—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∑–∞–º–µ—Ç–∫–∏, –≥–¥–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª–æ—Å—å, —á—Ç–æ `–Ω—Å` –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã `–≤—ã–≤–æ–¥` –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏. –¢–µ–ø–µ—Ä—å —è—Å–Ω–æ: `–≤—ã–≤–æ–¥` –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∞ `–Ω—Å` —è–≤–ª—è–µ—Ç—Å—è —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –Ω–∞ –µ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ.

---

## 5. ‚úÖ –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–• –§–£–ù–ö–¶–ò–ô (–ó–ê–í–ï–†–®–ï–ù–û!)

### ‚úÖ MILESTONE: –ü–æ–ª–Ω–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –§—É–Ω–∫—Ü–∏–π

**üéâ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ü–†–û–†–´–í (2 –∏—é–Ω—è 2025):** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—é—Ç!

#### ‚úÖ 5.1. –§–∞–∑–∞ 1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ì—Ä–∞–º–º–∞—Ç–∏–∫–∏ –∏ –ü–∞—Ä—Å–∏–Ω–≥ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π

**–°–¢–ê–¢–£–°: –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í–û** - –ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∞–ª–∞ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:
- ‚úÖ –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: `–∞–ª–≥`, `–∞—Ä–≥`, `—Ä–µ–∑`, `–∞—Ä–≥—Ä–µ–∑`, `–∑–Ω–∞—á`, `–Ω–∞—á`, `–∫–æ–Ω`
- ‚úÖ –ü—Ä–∞–≤–∏–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: `algorithmDefinition`, `parameterList`, `parameterDeclaration`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤ –∏ –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π

#### ‚úÖ 5.2. –§–∞–∑–∞ 2: –°–æ–∑–¥–∞–Ω–∏–µ –°—Ç—Ä—É–∫—Ç—É—Ä –¥–ª—è –•—Ä–∞–Ω–µ–Ω–∏—è –ê–ª–≥–æ—Ä–∏—Ç–º–æ–≤

**–ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û:**
- ‚úÖ **–ö–ª–∞—Å—Å `Parameter`** –≤ `definitions.py` - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å —Ç–∏–ø–∞–º–∏ –∏ —Ä–µ–∂–∏–º–∞–º–∏
- ‚úÖ **–ö–ª–∞—Å—Å `AlgorithmDefinition`** - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- ‚úÖ **–ö–ª–∞—Å—Å `AlgorithmManager`** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- ‚úÖ **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ `FunctionReturnException`** - –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ `–∑–Ω–∞—á := –≤—ã—Ä–∞–∂–µ–Ω–∏–µ`
- ‚úÖ **–î–≤—É—Ö–ø—Ä–æ—Ö–æ–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** - —Å–±–æ—Ä –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π + –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

#### ‚úÖ 5.3. –§–∞–∑–∞ 3.1: –ü–æ–ª–Ω–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è –§—É–Ω–∫—Ü–∏–π

**–°–¢–ê–¢–£–°: –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û!**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ **–í—ã–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –≤—ã—Ä–∞–∂–µ–Ω–∏–π**
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç—è–º–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏**
- ‚úÖ **–ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é (—Ä–µ–∂–∏–º `–∞—Ä–≥`)**
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤**
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ `–∑–Ω–∞—á := –≤—ã—Ä–∞–∂–µ–Ω–∏–µ` –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π**
- ‚úÖ **–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π**
- ‚úÖ **–í–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π**
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Expression Evaluator**

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```
‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: —Å—É–º–º–∞(2, 3) ‚Üí 5
‚úÖ –†–µ–∫—É—Ä—Å–∏—è: —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª(5) ‚Üí 120
‚úÖ –õ–æ–≥–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏: —á–µ—Ç–Ω–æ–µ(4) ‚Üí –¥–∞
‚úÖ –í–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã: —Ñ—É–Ω–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π
‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ int/float/bool
```

#### üîÑ 5.4. –§–∞–∑–∞ 3.2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–í –ü–†–û–¶–ï–°–°–ï)

**–¢–ï–ö–£–©–ê–Ø –ó–ê–î–ê–ß–ê:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ —Å—Å—ã–ª–∫–µ

**–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:**
- üîÑ **–†–µ–∂–∏–º `—Ä–µ–∑`** - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã–≤–æ–¥–∞
- üîÑ **–†–µ–∂–∏–º `–∞—Ä–≥—Ä–µ–∑`** - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ (–ø–æ —Å—Å—ã–ª–∫–µ)
- üîÑ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**
- üîÑ **–ü—Ä–æ—Ü–µ–¥—É—Ä—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ä–µ–∑/–∞—Ä–≥—Ä–µ–∑**

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ (—É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –∫–æ–¥–µ):**
- –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤—ã (Parameter.mode –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ä–µ–∂–∏–º—ã)
- –õ–æ–≥–∏–∫–∞ –¥–ª—è `—Ä–µ–∑` –∏ `–∞—Ä–≥—Ä–µ–∑` –Ω–∞–ø–∏—Å–∞–Ω–∞ –≤ `_call_user_function`
- –ù—É–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `_call_user_procedure`

---

## 6. –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–ê–†–ê–ú–ï–¢–†–û–í –§–£–ù–ö–¶–ò–ô - –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê (–í –ü–†–û–¶–ï–°–°–ï)

**‚úÖ –ü–†–û–ì–†–ï–°–° 03.06.2025:** –ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤!

**–î–û–°–¢–ò–ñ–ï–ù–ò–Ø:**
1. **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π:** –§—É–Ω–∫—Ü–∏—è `–£–¥–≤–æ–∏—Ç—å` —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å 1 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
2. **‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_convert_mode_to_evaluator_mode()`:** –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –ö—É–ú–∏—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç evaluator
3. **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:** –í—Å–µ –æ—Ç—Å—Ç—É–ø—ã –∏ –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ `procedure_manager.py`
4. **‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è `_extract_parameters()`:** –¢–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ `register_procedure()` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–¢–ï–ö–£–©–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:** 
- –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä 'x' –ù–ï –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏
- –û—à–∏–±–∫–∞: `KumirNameError: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è 'x' –Ω–µ –æ–±—ä—è–≤–ª–µ–Ω–∞. (—Å—Ç—Ä–æ–∫–∞ 4, —Å—Ç–æ–ª–±–µ—Ü 13)`

**–ß–¢–û –†–ê–ë–û–¢–ê–ï–¢:**
```
[DEBUG][ProcedureManager] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∞–ª–≥–æ—Ä–∏—Ç–º '–£–¥–≤–æ–∏—Ç—å' (—Ñ—É–Ω–∫—Ü–∏—è: True) —Å 1 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
```

**–ß–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢:**
- –ü—Ä–∏ –≤—ã–∑–æ–≤–µ `–£–¥–≤–æ–∏—Ç—å(5)` –ø–∞—Ä–∞–º–µ—Ç—Ä 'x' –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –º–µ—Å—Ç–æ, –≥–¥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã –æ–±—ä—è–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é

**–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:**
1. üîß –ù–∞–π—Ç–∏ –º–µ—Å—Ç–æ –≤ –∫–æ–¥–µ, –≥–¥–µ –æ–±—ä—è–≤–ª—è—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é 
2. üîß –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `_execute_procedure_call()` –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏
3. üîß –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ scope_manager –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏
4. üîß –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–§–ê–ô–õ–´ –í –†–ê–ë–û–¢–ï:**
- `procedure_manager.py` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- `test_direct.py` - —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `–£–¥–≤–æ–∏—Ç—å(–∞—Ä–≥ —Ü–µ–ª x)`
- `old-interpreter.py` - —ç—Ç–∞–ª–æ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

---

### üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–û–°–õ–ï–î–ù–ï–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:

**‚úÖ –£–°–ü–ï–®–ù–´–ï –¢–ï–°–¢–´:**
- `test_complex_function.py` - ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 25 (–°—É–º–º–∞(–ö–≤–∞–¥—Ä–∞—Ç(3), –ö–≤–∞–¥—Ä–∞—Ç(4)))
- `test_direct.py` - ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 10 (–£–¥–≤–æ–∏—Ç—å(5))
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã: `func-sumdig.kum` - ‚úÖ PASSED
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã: `func-prime.kum` - ‚úÖ PASSED

**üìà –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–´–• –¢–ï–°–¢–û–í:**
- –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 64
- –§—É–Ω–∫—Ü–∏–∏: 3 –∏–∑ 3 –ø—Ä–æ—à–ª–∏ (100%)
- –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è: 26 –∏–∑ 64 (‚âà40%)

**‚ùå –û–°–¢–ê–õ–¨–ù–´–ï –ù–ï–£–°–ü–ï–®–ù–´–ï –¢–ï–°–¢–´** —Å–≤—è–∑–∞–Ω—ã —Å –¥—Ä—É–≥–∏–º–∏ —á–∞—Å—Ç—è–º–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞:
- –°—Ç—Ä–æ–∫–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (`str-*`)
- –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (`cf_*`) 
- –ú–∞—Ç—Ä–∏—Ü—ã (`matr-*`)
- –ù–ï –°–í–Ø–ó–ê–ù–´ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –±–∞–≥–æ–º —Ñ—É–Ω–∫—Ü–∏–π

### üéØ –ö–õ–Æ–ß–ï–í–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –í –ö–û–î–ï:

**–§–∞–π–ª:** `pyrobot/backend/kumir_interpreter/interpreter_components/expression_evaluator.py`
**–ú–µ—Ç–æ–¥:** `visitQualifiedIdentifier` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 650)
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–≤–æ–π–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ KumirValue –æ–±—ä–µ–∫—Ç–æ–≤
**–†–µ—à–µ–Ω–∏–µ:**
```python
# value —É–∂–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å KumirValue, –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ
if isinstance(value, KumirValue):
    return value
else:
    # –ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ value –Ω–µ KumirValue, —Å–æ–∑–¥–∞–µ–º –µ–≥–æ
    kumir_type_str = kumir_type.value if hasattr(kumir_type, 'value') else str(kumir_type)
    return KumirValue(value, kumir_type_str)
```

### üîÑ –û–ë–õ–ê–°–¢–¨ –í–ò–î–ò–ú–û–°–¢–ò (SCOPE MANAGEMENT):

**–§–∞–π–ª:** `pyrobot/backend/kumir_interpreter/interpreter_components/procedure_manager.py`
**–ú–µ—Ç–æ–¥:** `execute_user_function`
**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```python
# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏
self.scope_manager.push_scope()
try:
    # ... –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ ...
finally:
    # –£–±–∏—Ä–∞–µ–º –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏
    self.scope_manager.pop_scope()
```

## üéâ –ü–û–õ–ù–û–ï –ó–ê–í–ï–†–®–ï–ù–ò–ï –ó–ê–î–ê–ß–ò - 03.01.2025 15:30

**üèÜ –£–°–ü–ï–®–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–´ –í–°–ï –ë–ê–ì–ò –° –§–£–ù–ö–¶–ò–Ø–ú–ò!**

### üìä –§–ò–ù–ê–õ–¨–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:

**‚úÖ –¢–ï–°–¢ 1: –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è** - –ü–†–û–ô–î–ï–ù
- `–£–¥–≤–æ–∏—Ç—å(7)` ‚Üí `14` ‚úÖ

**‚úÖ –¢–ï–°–¢ 2: –§—É–Ω–∫—Ü–∏—è —Å –¥–≤—É–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏** - –ü–†–û–ô–î–ï–ù  
- `–°—É–º–º–∞(15, 25)` ‚Üí `40` ‚úÖ

**‚úÖ –¢–ï–°–¢ 3: –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –ü–†–û–ô–î–ï–ù
- `–°—É–º–º–∞(–ö–≤–∞–¥—Ä–∞—Ç(3), –ö–≤–∞–¥—Ä–∞—Ç(4))` ‚Üí `25` ‚úÖ

**‚úÖ –¢–ï–°–¢ 4: –°–ª–æ–∂–Ω—ã–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** - –ü–†–û–ô–î–ï–ù
- `–§–æ—Ä–º—É–ª–∞(8, 3)` –≥–¥–µ `(x+y)*(x-y)+x*y` ‚Üí `79` ‚úÖ

### üîß –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û:

1. **‚ùå‚ûú‚úÖ –î–≤–æ–π–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ KumirValue** –≤ `expression_evaluator.py:visitQualifiedIdentifier`
2. **‚ùå‚ûú‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏** –≤ `procedure_manager.py:execute_user_function`  
3. **‚ùå‚ûú‚úÖ –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤** –≤ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
4. **‚ùå‚ûú‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏** –≤ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–æ–º –º–µ–Ω–µ–¥–∂–µ—Ä–µ

### üéØ –ò–¢–û–ì–û–í–û–ï –°–û–°–¢–û–Ø–ù–ò–ï:
- **–§—É–Ω–∫—Ü–∏–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏**: ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- **–í–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π**: ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é  
- **–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- **–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**: ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- **–ò–∑–æ–ª—è—Ü–∏—è scope**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é

**üìà –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –ø–æ —Ñ—É–Ω–∫—Ü–∏—è–º: 100%**
