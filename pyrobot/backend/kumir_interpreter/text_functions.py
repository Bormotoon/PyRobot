# text_functions.py
"""
Модуль для обработки текста в языке КУМИР.
Реализованы следующие функции:
  - длин(строка): возвращает количество символов в строке.
  - код(c): возвращает порядковый номер символа c в таблице CP-1251.
  - юникод(c): возвращает Unicode-код символа c.
  - символ(n): возвращает символ по CP-1251 коду n.
  - юнисимвол(n): возвращает символ по Unicode-коду n.
"""


def длин(строка):
    """
    Возвращает количество символов в строке.

    Пример:
      длин("Привет") → 6
    """
    return len(str(строка))


def код(c):
    """
    Возвращает порядковый номер символа c в таблице CP-1251.
    Если c не является строкой длиной 1, возбуждает исключение.

    Пример:
      код("А") → 192   (в CP-1251 буква А имеет код 192)
    """
    s = str(c)
    if len(s) != 1:
        raise ValueError("Функция 'код' принимает строку длиной 1")
    try:
        encoded = s.encode('cp1251')
    except Exception as e:
        raise ValueError(f"Ошибка кодирования символа '{s}' в CP-1251: {e}")
    return encoded[0]


def юникод(c):
    """
    Возвращает Unicode-код символа c.

    Пример:
      юникод("А") → 1040
    """
    s = str(c)
    if len(s) != 1:
        raise ValueError("Функция 'юникод' принимает строку длиной 1")
    return ord(s)


def символ(n):
    """
    Возвращает символ, соответствующий CP-1251 коду n.
    Если число n не соответствует допустимому байту, возбуждает исключение.

    Пример:
      символ(192) → "А"
    """
    try:
        n_int = int(n)
        b = bytes([n_int])
        return b.decode('cp1251')
    except Exception as e:
        raise ValueError(f"Ошибка преобразования числа {n} в символ CP-1251: {e}")


def юнисимвол(n):
    """
    Возвращает символ, соответствующий Unicode-коду n.

    Пример:
      юнисимвол(1040) → "А"
    """
    try:
        return chr(int(n))
    except Exception as e:
        raise ValueError(f"Ошибка преобразования числа {n} в Unicode символ: {e}")
